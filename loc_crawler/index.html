<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:image:alt" content="Justin Napolitano"/><meta data-react-helmet="true" name="twitter:image" content="undefined/static/794367035c6138c43c02f27abdaa40e6/20b93/post-image.jpg"/><meta data-react-helmet="true" name="og:image:alt" content="Justin Napolitano"/><meta data-react-helmet="true" name="og:image" content="undefined/static/794367035c6138c43c02f27abdaa40e6/20b93/post-image.jpg"/><meta data-react-helmet="true" name="twitter:description" content="Crawl the Library of Congress API to automate your next research project."/><meta data-react-helmet="true" name="twitter:title" content="Crawling the Library of Congress API"/><meta data-react-helmet="true" name="twitter:creator" content="just_napolitano"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" property="og:description" content="Crawl the Library of Congress API to automate your next research project."/><meta data-react-helmet="true" property="og:title" content="Crawling the Library of Congress API"/><meta data-react-helmet="true" name="description" content="Crawl the Library of Congress API to automate your next research project."/><meta name="generator" content="Gatsby 4.12.1"/><style data-href="/styles.5ed63f97d76756aacddc.css" data-identity="gatsby-global-css">@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/static/montserrat-latin-100-8d7d79679b70dbe27172b6460e7a7910.woff2) format("woff2"),url(/static/montserrat-latin-100-ec38980a9e0119a379e2a9b3dbb1901a.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/static/montserrat-latin-100italic-e279051046ba1286706adc886cf1c96b.woff2) format("woff2"),url(/static/montserrat-latin-100italic-3b325a3173c8207435cd1b76e19bf501.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/static/montserrat-latin-200-9d266fbbfa6cab7009bd56003b1eeb67.woff2) format("woff2"),url(/static/montserrat-latin-200-2d8ba08717110d27122e54c34b8a5798.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/static/montserrat-latin-200italic-6e5b3756583bb2263eb062eae992735e.woff2) format("woff2"),url(/static/montserrat-latin-200italic-a0d6f343e4b536c582926255367a57da.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/static/montserrat-latin-300-00b3e893aab5a8fd632d6342eb72551a.woff2) format("woff2"),url(/static/montserrat-latin-300-ea303695ceab35f17e7d062f30e0173b.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/static/montserrat-latin-300italic-56f34ea368f6aedf89583d444bbcb227.woff2) format("woff2"),url(/static/montserrat-latin-300italic-54b0bf2c8c4c12ffafd803be2466a790.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/static/montserrat-latin-400-b71748ae4f80ec8c014def4c5fa8688b.woff2) format("woff2"),url(/static/montserrat-latin-400-0659a9f4e90db5cf51b50d005bff1e41.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/static/montserrat-latin-400italic-6eed6b4cbb809c6efc7aa7ddad6dbe3e.woff2) format("woff2"),url(/static/montserrat-latin-400italic-7583622cfde30ae49086d18447ab28e7.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/static/montserrat-latin-500-091b209546e16313fd4f4fc36090c757.woff2) format("woff2"),url(/static/montserrat-latin-500-edd311588712a96bbf435fad264fff62.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/static/montserrat-latin-500italic-c90ced68b46050061d1a41842d6dfb43.woff2) format("woff2"),url(/static/montserrat-latin-500italic-5146cbfe02b1deea5dffea27a5f2f998.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/static/montserrat-latin-600-0480d2f8a71f38db8633b84d8722e0c2.woff2) format("woff2"),url(/static/montserrat-latin-600-b77863a375260a05dd13f86a1cee598f.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/static/montserrat-latin-600italic-cf46ffb11f3a60d7df0567f8851a1d00.woff2) format("woff2"),url(/static/montserrat-latin-600italic-c4fcfeeb057724724097167e57bd7801.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/static/montserrat-latin-700-7dbcc8a5ea2289d83f657c25b4be6193.woff2) format("woff2"),url(/static/montserrat-latin-700-99271a835e1cae8c76ef8bba99a8cc4e.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/static/montserrat-latin-700italic-c41ad6bdb4bd504a843d546d0a47958d.woff2) format("woff2"),url(/static/montserrat-latin-700italic-6779372f04095051c62ed36bc1dcc142.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/static/montserrat-latin-800-db9a3e0ba7eaea32e5f55328ace6cf23.woff2) format("woff2"),url(/static/montserrat-latin-800-4e3c615967a2360f5db87d2f0fd2456f.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/static/montserrat-latin-800italic-bf45bfa14805969eda318973947bc42b.woff2) format("woff2"),url(/static/montserrat-latin-800italic-fe82abb0bcede51bf724254878e0c374.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/static/montserrat-latin-900-e66c7edc609e24bacbb705175669d814.woff2) format("woff2"),url(/static/montserrat-latin-900-8211f418baeb8ec880b80ba3c682f957.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/static/montserrat-latin-900italic-4454c775e48152c1a72510ceed3603e2.woff2) format("woff2"),url(/static/montserrat-latin-900italic-efcaa0f6a82ee0640b83a0916e6e8d68.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/static/merriweather-latin-300-fc117160c69a8ea0851b26dd14748ee4.woff2) format("woff2"),url(/static/merriweather-latin-300-58b18067ebbd21fda77b67e73c241d3b.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/static/merriweather-latin-300italic-fe29961474f8dbf77c0aa7b9a629e4bc.woff2) format("woff2"),url(/static/merriweather-latin-300italic-23c3f1f88683618a4fb8d265d33d383a.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/static/merriweather-latin-400-d9479e8023bef9cbd9bf8d6eabd6bf36.woff2) format("woff2"),url(/static/merriweather-latin-400-040426f99ff6e00b86506452e0d1f10b.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/static/merriweather-latin-400italic-2de7bfeaf08fb03d4315d49947f062f7.woff2) format("woff2"),url(/static/merriweather-latin-400italic-79db67aca65f5285964ab332bd65f451.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/static/merriweather-latin-700-4b08e01d805fa35d7bf777f1b24314ae.woff2) format("woff2"),url(/static/merriweather-latin-700-22fb8afba4ab1f093b6ef9e28a9b6e92.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/static/merriweather-latin-700italic-cd92541b177652fffb6e3b952f1c33f1.woff2) format("woff2"),url(/static/merriweather-latin-700italic-f87f3d87cea0dd0979bfc8ac9ea90243.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/static/merriweather-latin-900-f813fc6a4bee46eda5224ac7ebf1b7be.woff2) format("woff2"),url(/static/merriweather-latin-900-5d4e42cb44410674acd99153d57df032.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/static/merriweather-latin-900italic-b7901d85486871c1779c0e93ddd85656.woff2) format("woff2"),url(/static/merriweather-latin-900italic-9647f9fdab98756989a8a5550eb205c3.woff) format("woff")}


/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{-webkit-text-size-adjust:100%;line-height:1.15}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}[hidden]{display:none}:root{--maxWidth-none:"none";--maxWidth-xs:20rem;--maxWidth-sm:24rem;--maxWidth-md:28rem;--maxWidth-lg:32rem;--maxWidth-xl:36rem;--maxWidth-2xl:42rem;--maxWidth-3xl:48rem;--maxWidth-4xl:56rem;--maxWidth-full:"100%";--maxWidth-wrapper:var(--maxWidth-2xl);--spacing-px:"1px";--spacing-0:0;--spacing-1:0.25rem;--spacing-2:0.5rem;--spacing-3:0.75rem;--spacing-4:1rem;--spacing-5:1.25rem;--spacing-6:1.5rem;--spacing-8:2rem;--spacing-10:2.5rem;--spacing-12:3rem;--spacing-16:4rem;--spacing-20:5rem;--spacing-24:6rem;--spacing-32:8rem;--fontFamily-sans:Montserrat,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--fontFamily-serif:"Merriweather","Georgia",Cambria,"Times New Roman",Times,serif;--font-body:var(--fontFamily-serif);--font-heading:var(--fontFamily-sans);--fontWeight-normal:400;--fontWeight-medium:500;--fontWeight-semibold:600;--fontWeight-bold:700;--fontWeight-extrabold:800;--fontWeight-black:900;--fontSize-root:16px;--lineHeight-none:1;--lineHeight-tight:1.1;--lineHeight-normal:1.5;--lineHeight-relaxed:1.625;--fontSize-0:0.833rem;--fontSize-1:1rem;--fontSize-2:1.2rem;--fontSize-3:1.44rem;--fontSize-4:1.728rem;--fontSize-5:2.074rem;--fontSize-6:2.488rem;--fontSize-7:2.986rem;--color-primary:#005b99;--color-text:#2e353f;--color-text-light:#4f5969;--color-heading:#1a202c;--color-heading-black:#000;--color-accent:#d1dce5}*,:after,:before{box-sizing:border-box}html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font-size:var(--fontSize-root);line-height:var(--lineHeight-normal)}body{color:var(--color-text);font-family:var(--font-body);font-size:var(--fontSize-1)}footer{padding:var(--spacing-6) var(--spacing-0)}hr{background:var(--color-accent);border:0;height:1px}h1,h2,h3,h4,h5,h6{font-family:var(--font-heading);letter-spacing:-.025em;line-height:var(--lineHeight-tight);margin-bottom:var(--spacing-6);margin-top:var(--spacing-12)}h2,h3,h4,h5,h6{color:var(--color-heading);font-weight:var(--fontWeight-bold)}h1{color:var(--color-heading-black);font-size:var(--fontSize-6);font-weight:var(--fontWeight-black)}h2{font-size:var(--fontSize-5)}h3{font-size:var(--fontSize-4)}h4{font-size:var(--fontSize-3)}h5{font-size:var(--fontSize-2)}h6{font-size:var(--fontSize-1)}h1>a,h2>a,h3>a,h4>a,h5>a,h6>a{color:inherit;text-decoration:none}p{--baseline-multiplier:0.179;--x-height-multiplier:0.35;line-height:var(--lineHeight-relaxed);margin:var(--spacing-0) var(--spacing-0) var(--spacing-8) var(--spacing-0)}ol,p,ul{padding:var(--spacing-0)}ol,ul{list-style-image:none;list-style-position:outside;margin-bottom:var(--spacing-8);margin-left:var(--spacing-0);margin-right:var(--spacing-0)}ol li,ul li{padding-left:var(--spacing-0)}li>p,ol li,ul li{margin-bottom:calc(var(--spacing-8)/2)}li :last-child{margin-bottom:var(--spacing-0)}li>ul{margin-left:var(--spacing-8);margin-top:calc(var(--spacing-8)/2)}blockquote{border-left:var(--spacing-1) solid var(--color-primary);color:var(--color-text-light);font-size:var(--fontSize-2);font-style:italic;margin-bottom:var(--spacing-8);margin-left:calc(var(--spacing-6)*-1);margin-right:var(--spacing-8);padding:var(--spacing-0) var(--spacing-0) var(--spacing-0) var(--spacing-6)}blockquote>:last-child{margin-bottom:var(--spacing-0)}blockquote>ol,blockquote>ul{list-style-position:inside}table{border-collapse:collapse;border-spacing:.25rem;margin-bottom:var(--spacing-8);width:100%}table thead tr th{border-bottom:1px solid var(--color-accent)}a{color:var(--color-primary)}a:focus,a:hover{text-decoration:none}.global-wrapper{margin:var(--spacing-0) auto;max-width:var(--maxWidth-wrapper);padding:var(--spacing-10) var(--spacing-5)}.global-wrapper[data-is-root-path=true] .bio{margin-bottom:var(--spacing-20)}.global-header{margin-bottom:var(--spacing-12)}.main-heading{font-size:var(--fontSize-7);margin:0}.post-list-item{margin-bottom:var(--spacing-8);margin-top:var(--spacing-8)}.post-list-item p{margin-bottom:var(--spacing-0)}.post-list-item h2{color:var(--color-primary);font-size:var(--fontSize-4);margin-bottom:var(--spacing-2);margin-top:var(--spacing-0)}.post-list-item header{margin-bottom:var(--spacing-4)}.header-link-home{font-family:var(--font-heading);font-size:var(--fontSize-2);font-weight:var(--fontWeight-bold);text-decoration:none}.bio{display:flex;margin-bottom:var(--spacing-16)}.bio p,.bio-avatar{margin-bottom:var(--spacing-0)}.bio-avatar{border-radius:100%;margin-right:var(--spacing-4);min-width:50px}.blog-post header h1{margin:var(--spacing-0) var(--spacing-0) var(--spacing-4) var(--spacing-0)}.blog-post header p{font-family:var(--font-heading);font-size:var(--fontSize-2)}.blog-post-nav ul{margin:var(--spacing-0)}.gatsby-highlight{margin-bottom:var(--spacing-8)}@media (max-width:42rem){blockquote{margin-left:var(--spacing-0);padding:var(--spacing-0) var(--spacing-0) var(--spacing-0) var(--spacing-4)}ol,ul{list-style-position:inside}}code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#000;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;-o-tab-size:4;tab-size:4;text-align:left;text-shadow:0 1px #fff;white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{background:#b3d4fc;text-shadow:none}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{background:hsla(0,0%,100%,.5);color:#9a6e3a}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="alternate" type="application/rss+xml" title="Gatsby Starter Blog RSS Feed" href="/rss.xml"/><link rel="icon" href="/favicon-32x32.png?v=e8d56e807ace6dccd6cb4fe2ee4f7ab7" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=e8d56e807ace6dccd6cb4fe2ee4f7ab7"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=e8d56e807ace6dccd6cb4fe2ee4f7ab7"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=e8d56e807ace6dccd6cb4fe2ee4f7ab7"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=e8d56e807ace6dccd6cb4fe2ee4f7ab7"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=e8d56e807ace6dccd6cb4fe2ee4f7ab7"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=e8d56e807ace6dccd6cb4fe2ee4f7ab7"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=e8d56e807ace6dccd6cb4fe2ee4f7ab7"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=e8d56e807ace6dccd6cb4fe2ee4f7ab7"/><title data-react-helmet="true">Crawling the Library of Congress API | Justin&#x27;s Data Blog</title><link as="script" rel="preload" href="/webpack-runtime-8d4d3bcfd5afb11d1043.js"/><link as="script" rel="preload" href="/framework-e413e527015be9a1bdfd.js"/><link as="script" rel="preload" href="/app-c8d1e6b1e07552f29524.js"/><link as="script" rel="preload" href="/commons-9979cba14fa891b0ecd4.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-2fd61fd1c97edc75b172.js"/><link as="fetch" rel="preload" href="/page-data/loc_crawler/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2841359383.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3257411868.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="global-wrapper" data-is-root-path="false"><header class="global-header"><a class="header-link-home" href="/">Justin&#x27;s Data Blog</a></header><main><article class="blog-post" itemscope="" itemType="http://schema.org/Article"><header><h1 itemProp="headline">Crawling the Library of Congress API</h1><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper"><div aria-hidden="true" style="padding-top:66.75%"></div><img aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear" decoding="async" src="data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAEDBP/EABYBAQEBAAAAAAAAAAAAAAAAAAMAAf/aAAwDAQACEAMQAAABTxTJNBAy/8QAGxAAAwACAwAAAAAAAAAAAAAAAAECAxESEyH/2gAIAQEAAQUCnK2XWzsoXhLOJ//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAEDAQE/AUf/xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAgEBPwGK/8QAGhAAAgIDAAAAAAAAAAAAAAAAABEBAiAhMf/aAAgBAQAGPwJ23hLOn//EABoQAAMBAQEBAAAAAAAAAAAAAAABESFBkTH/2gAIAQEAAT8hcODeCJk9HwecxGjS+7o11qCqyD//2gAMAwEAAgADAAAAEHDf/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAR/9oACAEDAQE/ENITf//EABcRAQEBAQAAAAAAAAAAAAAAAAERACH/2gAIAQIBAT8QK7kjLv/EABoQAQADAQEBAAAAAAAAAAAAAAEAESExgfD/2gAIAQEAAT8QKxJTYWz7kxIBrXUahSMpwuEBXTTeZyDuoLr2X0hHk//Z" alt=""/><picture><source type="image/avif" data-srcset="/static/794367035c6138c43c02f27abdaa40e6/b56ea/post-image.avif 750w,/static/794367035c6138c43c02f27abdaa40e6/ba9bc/post-image.avif 800w" sizes="100vw"/><source type="image/webp" data-srcset="/static/794367035c6138c43c02f27abdaa40e6/d2a19/post-image.webp 750w,/static/794367035c6138c43c02f27abdaa40e6/56f2e/post-image.webp 800w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" data-src="/static/794367035c6138c43c02f27abdaa40e6/20b93/post-image.jpg" data-srcset="/static/794367035c6138c43c02f27abdaa40e6/6cce3/post-image.jpg 750w,/static/794367035c6138c43c02f27abdaa40e6/20b93/post-image.jpg 800w" alt="Justin Napolitano"/></picture><noscript><picture><source type="image/avif" srcSet="/static/794367035c6138c43c02f27abdaa40e6/b56ea/post-image.avif 750w,/static/794367035c6138c43c02f27abdaa40e6/ba9bc/post-image.avif 800w" sizes="100vw"/><source type="image/webp" srcSet="/static/794367035c6138c43c02f27abdaa40e6/d2a19/post-image.webp 750w,/static/794367035c6138c43c02f27abdaa40e6/56f2e/post-image.webp 800w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" src="/static/794367035c6138c43c02f27abdaa40e6/20b93/post-image.jpg" srcSet="/static/794367035c6138c43c02f27abdaa40e6/6cce3/post-image.jpg 750w,/static/794367035c6138c43c02f27abdaa40e6/20b93/post-image.jpg 800w" alt="Justin Napolitano"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1)}}</script></div><p>May 16, 2022</p><p>Crawl the Library of Congress API to automate your next research project.</p><p>Justin napolitano</p></header><section itemProp="articleBody"><h1>Crawling the Library of Congress API</h1>
<h2>Introduction</h2>
<p>The United States Library of Congress maintains a rest api for developers to crawl their collections.  It is an open source tool that anyone can access in order to conduct research. Check out the documenation at <a href="https://libraryofcongress.github.io/data-exploration/">https://libraryofcongress.github.io/data-exploration/</a>.</p>
<h2>Creating a crawler</h2>
<p>I took the approach of writing a generator that produces a search result page object that can be operated upon with each iteration.</p>
<p>The first step is to create a search result page object.</p>
<p>The code below documents the search_result page.  It contains a number of helper functions to convert the nodes within the result to json or graphml.  The code can also be used to generate a networkx in memory graph.</p>
<h3>The Search Result Object</h3>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">search_results_page</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>base_url <span class="token operator">=</span> <span class="token string">"https://www.loc.gov/collections"</span><span class="token punctuation">,</span>collection <span class="token operator">=</span> <span class="token string">"united-states-reports"</span><span class="token punctuation">,</span>json_parameter <span class="token operator">=</span> <span class="token string">"fo=json"</span><span class="token punctuation">,</span>results_per_page <span class="token operator">=</span> <span class="token string">"c=79"</span><span class="token punctuation">,</span>query_param <span class="token operator">=</span> <span class="token string">"?"</span><span class="token punctuation">,</span>page_param <span class="token operator">=</span><span class="token string">"sp="</span><span class="token punctuation">,</span>page_num <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment">#pprint(num_columns)</span>
        self<span class="token punctuation">.</span>search_url <span class="token operator">=</span> self<span class="token punctuation">.</span>create_search_url<span class="token punctuation">(</span>base_url<span class="token punctuation">,</span>collection<span class="token punctuation">,</span>json_parameter<span class="token punctuation">,</span>results_per_page<span class="token punctuation">,</span>query_param<span class="token punctuation">,</span>page_param<span class="token punctuation">,</span>page_num<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>response <span class="token operator">=</span> self<span class="token punctuation">.</span>request_data<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>response_json <span class="token operator">=</span> self<span class="token punctuation">.</span>response_to_json<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">#self.soup_html = self.html_parse()</span>
        self<span class="token punctuation">.</span>next_url <span class="token operator">=</span> self<span class="token punctuation">.</span>get_next_url<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>page_num <span class="token operator">=</span> page_num

    <span class="token keyword">def</span> <span class="token function">to_json</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> file_name <span class="token operator">=</span> <span class="token string">'result_'</span><span class="token punctuation">,</span>file_num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> extension <span class="token operator">=</span><span class="token string">".json"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        output_name <span class="token operator">=</span> file_name <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>file_num<span class="token punctuation">)</span>
        output_name <span class="token operator">=</span> output_name <span class="token operator">+</span> extension
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>output_name<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> outfile<span class="token punctuation">:</span>
            json<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>self<span class="token punctuation">.</span>response_json<span class="token punctuation">,</span> outfile<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">to_pandas</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        df <span class="token operator">=</span> nx<span class="token punctuation">.</span>to_pandas_edgelist<span class="token punctuation">(</span>self<span class="token punctuation">.</span>graph<span class="token punctuation">)</span>
        <span class="token keyword">return</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">to_csv</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>file_name <span class="token operator">=</span> <span class="token string">'result_'</span><span class="token punctuation">,</span>file_num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> extension <span class="token operator">=</span><span class="token string">".csv"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        output_name <span class="token operator">=</span> file_name <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>file_num<span class="token punctuation">)</span>
        output_name <span class="token operator">=</span> output_name <span class="token operator">+</span> extension
        df <span class="token operator">=</span> self<span class="token punctuation">.</span>to_pandas<span class="token punctuation">(</span><span class="token punctuation">)</span>
        df<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span>output_name<span class="token punctuation">)</span>


    <span class="token keyword">def</span> <span class="token function">write_graphml</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>file_name <span class="token operator">=</span> <span class="token string">'result_'</span><span class="token punctuation">,</span> file_num<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> extension <span class="token operator">=</span> <span class="token string">".graphml"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        output_name <span class="token operator">=</span> file_name <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>file_num<span class="token punctuation">)</span>
        output_name <span class="token operator">=</span> output_name <span class="token operator">+</span> extension
        nx<span class="token punctuation">.</span>write_graphml<span class="token punctuation">(</span>self<span class="token punctuation">.</span>graph<span class="token punctuation">,</span> output_name<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">write_to_file</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>data <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">,</span> file_name <span class="token operator">=</span> <span class="token string">'result_'</span><span class="token punctuation">,</span>file_num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> extension <span class="token operator">=</span> <span class="token string">".json"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        output_name <span class="token operator">=</span> file_name <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>file_num<span class="token punctuation">)</span>
        output_name <span class="token operator">=</span> output_name <span class="token operator">+</span> extension
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>output_name<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> outfile<span class="token punctuation">:</span>
            json<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>data<span class="token punctuation">,</span> outfile<span class="token punctuation">)</span>


    <span class="token keyword">def</span> <span class="token function">node_gen_2</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">,</span> root <span class="token operator">=</span><span class="token string">'result'</span><span class="token punctuation">,</span> node_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> edge_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> previous_k <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">,</span> previous_edge <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">,</span> graph <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment">#root = root </span>
        <span class="token keyword">if</span> <span class="token builtin">type</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token keyword">is</span> <span class="token builtin">dict</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> data<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> k <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">and</span> k <span class="token keyword">not</span> <span class="token keyword">in</span> node_list<span class="token punctuation">:</span>
                    graph<span class="token punctuation">.</span>add_node<span class="token punctuation">(</span>k<span class="token punctuation">,</span> <span class="token builtin">type</span> <span class="token operator">=</span> k<span class="token punctuation">)</span>
                    <span class="token comment">#node_list.append((k, {'type' : k}))</span>
                    <span class="token comment">#(1, 2, color='red', weight=0.84, size=300)\</span>
                    graph<span class="token punctuation">.</span>add_edge<span class="token punctuation">(</span>root<span class="token punctuation">,</span>k<span class="token punctuation">,</span> relationship <span class="token operator">=</span> <span class="token string">"of"</span><span class="token punctuation">,</span> <span class="token builtin">type</span> <span class="token operator">=</span> <span class="token string">"root"</span><span class="token punctuation">)</span>
                    <span class="token comment">#edge_list.append((root , k, {"relationship" : "of"}, {"type" : 'root'}))</span>
                <span class="token comment">#pprint('passing_value')</span>
                <span class="token comment">#save k</span>
                previous_k <span class="token operator">=</span> k
                previous_edge <span class="token operator">=</span> <span class="token punctuation">(</span>root <span class="token punctuation">,</span> k<span class="token punctuation">)</span>
                self<span class="token punctuation">.</span>node_gen_2<span class="token punctuation">(</span>v<span class="token punctuation">,</span>root <span class="token operator">=</span> root<span class="token punctuation">,</span> node_list <span class="token operator">=</span> node_list<span class="token punctuation">,</span>edge_list <span class="token operator">=</span> edge_list<span class="token punctuation">,</span> previous_k <span class="token operator">=</span> k<span class="token punctuation">,</span> previous_edge <span class="token operator">=</span> previous_edge<span class="token punctuation">,</span> graph <span class="token operator">=</span> graph<span class="token punctuation">)</span>

        <span class="token keyword">elif</span> <span class="token builtin">type</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token keyword">is</span> <span class="token builtin">list</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> item <span class="token keyword">in</span> data<span class="token punctuation">:</span>
                <span class="token comment">#pprint('passing_data')</span>

                self<span class="token punctuation">.</span>node_gen_2<span class="token punctuation">(</span>item<span class="token punctuation">,</span>root <span class="token operator">=</span> root<span class="token punctuation">,</span> node_list <span class="token operator">=</span> node_list<span class="token punctuation">,</span>edge_list <span class="token operator">=</span> edge_list<span class="token punctuation">,</span>previous_k <span class="token operator">=</span> previous_k<span class="token punctuation">,</span> previous_edge<span class="token operator">=</span> previous_edge<span class="token punctuation">,</span> graph <span class="token operator">=</span> graph<span class="token punctuation">)</span>
                <span class="token comment">#create_edge to k</span>

        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment">#this item is no longer a dictionary or list</span>
            pprint<span class="token punctuation">(</span><span class="token string">'appending_data'</span><span class="token punctuation">)</span>
            <span class="token comment">#create edge to k</span>
            <span class="token keyword">if</span> data <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                graph<span class="token punctuation">.</span>add_node<span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token builtin">type</span> <span class="token operator">=</span> data<span class="token punctuation">)</span>
                <span class="token comment">#node_list.append((data, {"type" : data}))</span>
                graph<span class="token punctuation">.</span>add_edge<span class="token punctuation">(</span>previous_k<span class="token punctuation">,</span> data<span class="token punctuation">,</span> relationship <span class="token operator">=</span> <span class="token string">"is"</span><span class="token punctuation">,</span> <span class="token builtin">type</span> <span class="token operator">=</span> previous_k<span class="token punctuation">)</span>
                <span class="token comment">#edge_list.append((previous_k ,data,{'relationship': "is"}, {'type' : data}))</span>
                <span class="token comment">#edge_list.append((root,data))</span>

    <span class="token comment">#flatten(hierarchak)_dict)</span>
        <span class="token keyword">return</span> graph 

    
    <span class="token keyword">def</span> <span class="token function">node_runner</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>data<span class="token punctuation">,</span>graph<span class="token punctuation">)</span><span class="token punctuation">:</span>
        
        node_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        edge_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> item <span class="token keyword">in</span> data<span class="token punctuation">:</span>
            <span class="token comment">#root = item['title']</span>
            graph <span class="token operator">=</span> self<span class="token punctuation">.</span>node_gen_2<span class="token punctuation">(</span>data <span class="token operator">=</span> item<span class="token punctuation">,</span> node_list <span class="token operator">=</span> node_list<span class="token punctuation">,</span> graph <span class="token operator">=</span> graph<span class="token punctuation">)</span>
        <span class="token comment">#pprint(edge_list)</span>
        <span class="token keyword">return</span> graph

    <span class="token keyword">def</span> <span class="token function">node_generator</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">,</span> root <span class="token operator">=</span><span class="token string">'title_testing'</span><span class="token punctuation">,</span> node_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> edge_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> previous_k <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">,</span> previous_edge <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment">#pprint(data)</span>
        <span class="token keyword">if</span> <span class="token builtin">type</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token keyword">is</span> <span class="token builtin">dict</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> data<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> k <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">and</span> k <span class="token keyword">not</span> <span class="token keyword">in</span> node_list<span class="token punctuation">:</span>
                    node_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>k<span class="token punctuation">)</span>
                    edge_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>root <span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token comment">#pprint('passing_value')</span>
                <span class="token comment">#save k</span>
                previous_k <span class="token operator">=</span> k
                previous_edge <span class="token operator">=</span> <span class="token punctuation">(</span>root <span class="token punctuation">,</span> k<span class="token punctuation">)</span>
                self<span class="token punctuation">.</span>node_generator<span class="token punctuation">(</span>v<span class="token punctuation">,</span>root <span class="token operator">=</span> root<span class="token punctuation">,</span> node_list <span class="token operator">=</span> node_list<span class="token punctuation">,</span>edge_list <span class="token operator">=</span> edge_list<span class="token punctuation">,</span> previous_k <span class="token operator">=</span> k<span class="token punctuation">,</span> previous_edge <span class="token operator">=</span> previous_edge<span class="token punctuation">)</span>

        <span class="token keyword">elif</span> <span class="token builtin">type</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token keyword">is</span> <span class="token builtin">list</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> item <span class="token keyword">in</span> data<span class="token punctuation">:</span>
                <span class="token comment">#pprint('passing_data')</span>

                self<span class="token punctuation">.</span>node_generator<span class="token punctuation">(</span>item<span class="token punctuation">,</span>root <span class="token operator">=</span> root<span class="token punctuation">,</span> node_list <span class="token operator">=</span> node_list<span class="token punctuation">,</span>edge_list <span class="token operator">=</span> edge_list<span class="token punctuation">,</span>previous_k <span class="token operator">=</span> previous_k<span class="token punctuation">,</span> previous_edge<span class="token operator">=</span> previous_edge<span class="token punctuation">)</span>
                <span class="token comment">#create_edge to k</span>

        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment">#this item is no longer a dictionary or list</span>
            pprint<span class="token punctuation">(</span><span class="token string">'appending_data'</span><span class="token punctuation">)</span>
            <span class="token comment">#create edge to k</span>
            <span class="token keyword">if</span> data <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                node_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
                edge_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>previous_k <span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
                edge_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment">#flatten(hierarchak)_dict)</span>
        <span class="token keyword">return</span> node_list<span class="token punctuation">,</span> edge_list 
        <span class="token comment">#self.json_graph = self.create_json_graph()</span>


    <span class="token keyword">def</span> <span class="token function">create_json_graph</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment">#graph = nx.Graph(self.response_json)</span>
        graph <span class="token operator">=</span> nx<span class="token punctuation">.</span>from_dict_of_dicts<span class="token punctuation">(</span>self<span class="token punctuation">.</span>response_json<span class="token punctuation">)</span>
        <span class="token comment">#graph = json_graph.node_link_graph(self.response_json)</span>
        nx<span class="token punctuation">.</span>draw<span class="token punctuation">(</span>graph<span class="token punctuation">)</span>
        <span class="token keyword">return</span> graph
        
        <span class="token comment">#self.node_list = self.node_generator`</span>



    <span class="token keyword">def</span> <span class="token function">create_search_result_node</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
     
        <span class="token keyword">for</span> item <span class="token keyword">in</span> self<span class="token punctuation">.</span>response_json_flat<span class="token punctuation">:</span>
            <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> item<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> k <span class="token keyword">not</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>column_lookup_table<span class="token punctuation">:</span>
                    column_string <span class="token operator">=</span> self<span class="token punctuation">.</span>colnum_string<span class="token punctuation">(</span><span class="token punctuation">)</span>

                    self<span class="token punctuation">.</span>column_lookup_table<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>colnum_string<span class="token punctuation">(</span>self<span class="token punctuation">.</span>num_columns<span class="token punctuation">)</span>
                    self<span class="token punctuation">.</span>num_columns <span class="token operator">+=</span> <span class="token number">1</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    <span class="token keyword">continue</span>

    <span class="token keyword">def</span> <span class="token function">append_to_data_list</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>rnge<span class="token punctuation">,</span>d<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#rename to _data_list</span>
        request_body <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">'range'</span><span class="token punctuation">:</span> rnge<span class="token punctuation">,</span>
            <span class="token string">"majorDimension"</span><span class="token punctuation">:</span> <span class="token string">"COLUMNS"</span><span class="token punctuation">,</span>
            <span class="token string">"values"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>d<span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> request_body
        <span class="token comment">#data_list.append(request_body_tmp)</span>

    <span class="token keyword">def</span> <span class="token function">map_column_to_range</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>column_key<span class="token punctuation">)</span><span class="token punctuation">:</span>
        
        rnge <span class="token operator">=</span> <span class="token string">"'Sheet1'"</span> <span class="token operator">+</span> <span class="token string">"!"</span> <span class="token operator">+</span> column_key <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> rnge
                

    <span class="token keyword">def</span> <span class="token function">colnum_string</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>num_columns<span class="token punctuation">)</span><span class="token punctuation">:</span>
        string <span class="token operator">=</span> <span class="token string">""</span>
        <span class="token comment">#pprint("conlum_string")</span>
        <span class="token comment">#pprint(num_columns)</span>
        <span class="token keyword">while</span> num_columns <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>
            num_columns<span class="token punctuation">,</span> remainder <span class="token operator">=</span> <span class="token builtin">divmod</span><span class="token punctuation">(</span>num_columns <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">)</span>
            string <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">65</span> <span class="token operator">+</span> remainder<span class="token punctuation">)</span> <span class="token operator">+</span> string
            <span class="token comment">#pprint(string)</span>
        <span class="token keyword">return</span> string

    <span class="token keyword">def</span> <span class="token function">map_columns_to_lookup_table</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token comment">#print('first_map_columns_print')</span>
        <span class="token comment">#num_columns_tmp = self.num_columns</span>
        <span class="token comment">#pprint(num_columns_tmp)</span>
        <span class="token keyword">for</span> item <span class="token keyword">in</span> self<span class="token punctuation">.</span>response_json_flat<span class="token punctuation">:</span>
            <span class="token keyword">for</span> k <span class="token keyword">in</span> item<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                num_columns_tmp <span class="token operator">=</span> self<span class="token punctuation">.</span>num_columns
                <span class="token keyword">if</span> k <span class="token keyword">not</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>column_lookup_table<span class="token punctuation">:</span>
                    <span class="token comment">#print('second_map_Columns_print')</span>
                    <span class="token comment">#pprint(num_columns_tmp)</span>
                    self<span class="token punctuation">.</span>column_lookup_table<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>colnum_string<span class="token punctuation">(</span>num_columns <span class="token operator">=</span> num_columns_tmp<span class="token punctuation">)</span>
                    self<span class="token punctuation">.</span>num_columns <span class="token operator">=</span> self<span class="token punctuation">.</span>num_columns <span class="token operator">+</span> <span class="token number">1</span>
       
                    <span class="token comment">#append range to request... </span>
                    <span class="token comment">#append collumn to batch lookup</span>
                

                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    <span class="token keyword">continue</span>
    
    <span class="token keyword">def</span> <span class="token function">column_request_list_generator</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        request_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> self<span class="token punctuation">.</span>column_lookup_table<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            rnge <span class="token operator">=</span> self<span class="token punctuation">.</span>map_column_to_range<span class="token punctuation">(</span>k<span class="token punctuation">)</span>
            request_body <span class="token operator">=</span> self<span class="token punctuation">.</span>append_to_data_list<span class="token punctuation">(</span>rnge<span class="token punctuation">,</span>v<span class="token punctuation">)</span>
            <span class="token comment">#pprint(request_body)</span>
            request_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>request_body<span class="token punctuation">)</span>
        <span class="token keyword">return</span> request_list





        <span class="token comment">#return column_lookup_table</span>

    <span class="token keyword">def</span> <span class="token function">get_next_url</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>response_json<span class="token punctuation">[</span><span class="token string">'pagination'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'next'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">create_search_url</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>base_url<span class="token punctuation">,</span>collection<span class="token punctuation">,</span>json_parameter<span class="token punctuation">,</span>results_per_page<span class="token punctuation">,</span>query_param<span class="token punctuation">,</span>page_param<span class="token punctuation">,</span>page_num<span class="token punctuation">)</span><span class="token punctuation">:</span>
        url_sep <span class="token operator">=</span><span class="token string">"/"</span>
        page_param <span class="token operator">=</span> page_param <span class="token operator">+</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>page_num<span class="token punctuation">)</span><span class="token punctuation">)</span>
        query <span class="token operator">=</span> <span class="token string">"&amp;"</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span>json_parameter<span class="token punctuation">,</span>results_per_page<span class="token punctuation">,</span>page_param<span class="token punctuation">]</span><span class="token punctuation">)</span>
        query <span class="token operator">=</span> query_param <span class="token operator">+</span> query
        search_url <span class="token operator">=</span> url_sep<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span>base_url<span class="token punctuation">,</span>collection<span class="token punctuation">,</span>query<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token comment">#pprint(search_url)</span>
        
        <span class="token keyword">return</span> search_url

    <span class="token keyword">def</span> <span class="token function">say_hello</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        pprint<span class="token punctuation">(</span>self<span class="token punctuation">.</span>base_url<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">request_data</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        headers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'User-Agent'</span><span class="token punctuation">:</span><span class="token string">'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_2) AppleWebKit/601.3.11 (KHTML, like Gecko) Version/9.0.2 Safari/601.3.9'</span><span class="token punctuation">,</span>
                    <span class="token string">'Accept-Encoding'</span><span class="token punctuation">:</span> <span class="token string">'identity'</span>
                <span class="token punctuation">}</span>
        <span class="token keyword">return</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>self<span class="token punctuation">.</span>search_url<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">response_to_json</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">html_parse</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        soup<span class="token operator">=</span>BeautifulSoup<span class="token punctuation">(</span>self<span class="token punctuation">.</span>response<span class="token punctuation">.</span>content<span class="token punctuation">,</span><span class="token string">'lxml'</span><span class="token punctuation">)</span>
        <span class="token comment">#pprint(soup)</span>
        <span class="token keyword">return</span> soup

    <span class="token keyword">def</span> <span class="token function">flatten_result</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        flat_result_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> item <span class="token keyword">in</span> self<span class="token punctuation">.</span>response_json<span class="token punctuation">[</span><span class="token string">'results'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            flat_json <span class="token operator">=</span> flatten<span class="token punctuation">(</span>item<span class="token punctuation">)</span>
            flat_result_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>flat_json<span class="token punctuation">)</span>
        <span class="token keyword">return</span> flat_result_list
</code></pre></div>
<h2>The Generator</h2>
<p>The generator yields a search result page if the pagination link included in the response is valid.</p>
<p>Depending on your use case you could pass the page_num and collection you would like to crawl.</p>
<p>The api is limited to 80 results per minute.  The sleep function limits calls to the desired rate.  The amount of results returned can be passed to the search result page_object.  Review the code above to see which values can be passed.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">search_result_generator</span><span class="token punctuation">(</span>condition <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#column_lookup_table = {}</span>
    <span class="token comment">#pprint(num_columns)</span>
    page_num <span class="token operator">=</span> <span class="token number">1</span>
    column_lookup_table <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">while</span> condition <span class="token operator">==</span><span class="token boolean">True</span><span class="token punctuation">:</span>
        <span class="token comment">#pprint(num_columns)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">61</span><span class="token punctuation">)</span>
        search_results_page_object <span class="token operator">=</span> create_search_results_page_object<span class="token punctuation">(</span>page_num <span class="token operator">=</span> page_num<span class="token punctuation">)</span>
        <span class="token keyword">if</span> search_results_page_object<span class="token punctuation">.</span>next_url <span class="token operator">!=</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            condition <span class="token operator">=</span> <span class="token boolean">True</span>
            page_num <span class="token operator">=</span> page_num <span class="token operator">+</span> <span class="token number">1</span>            
            <span class="token keyword">yield</span> <span class="token punctuation">(</span>search_results_page_object<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            condition <span class="token operator">=</span> <span class="token boolean">False</span>
            <span class="token keyword">yield</span> <span class="token punctuation">(</span>search_results_page_object<span class="token punctuation">)</span></code></pre></div>
<h2>The Runner Function</h2>
<p>To initiate the crawl simply run the algorithm below.  It writes each result page to json.</p>
<p>As a follow up project, I will post how to integrate the data returned into a neo4j database.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">for</span> obj <span class="token keyword">in</span> search_result_generator<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>   
        page_num <span class="token operator">=</span> obj<span class="token punctuation">.</span>page_num
        <span class="token keyword">with</span> cd<span class="token punctuation">(</span><span class="token string">"output_2"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment">#print('hahaha')</span>
            obj<span class="token punctuation">.</span>to_json<span class="token punctuation">(</span>file_num <span class="token operator">=</span> page_num<span class="token punctuation">)</span>
            <span class="token comment">#obj.write_graphml(file_num= page_num)</span>
            <span class="token comment">#obj.to_pandas()</span>
            <span class="token comment">#obj.write_to_file(data = obj.dict_of_dicts, file_num = page_num)</span>
            <span class="token comment">#obj.to_csv()</span>
        write_last_page_num<span class="token punctuation">(</span>page_num<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{} Search Results Crawled"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>page_num<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div>
<h2>Putting Everything Together</h2>
<p>The code below is the entire program as it stands.  There is built in functionality to upload the results to a google sheet if that is what you desire using an extension of the google api.   That code can be found at <a href="https://github.com/justin-napolitano/GoogleAPI">https://github.com/justin-napolitano/GoogleAPI</a></p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token comment">#library_of_congress_scraper.py</span>
<span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function
<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> lxml<span class="token punctuation">.</span>etree <span class="token keyword">as</span> etree
<span class="token keyword">import</span> xml<span class="token punctuation">.</span>etree<span class="token punctuation">.</span>ElementTree <span class="token keyword">as</span> ET
<span class="token keyword">import</span> json
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> os
<span class="token keyword">import</span> time
<span class="token keyword">import</span> random
<span class="token keyword">import</span> math
<span class="token keyword">from</span> pprint <span class="token keyword">import</span> pprint
<span class="token comment">#import load_vars as lv</span>
<span class="token keyword">import</span> html
<span class="token keyword">import</span> yaml
<span class="token keyword">from</span> yaml <span class="token keyword">import</span> Loader<span class="token punctuation">,</span> Dumper
<span class="token keyword">import</span> glob
<span class="token keyword">import</span> datetime
<span class="token keyword">import</span> os<span class="token punctuation">.</span>path
<span class="token keyword">from</span> googleapiclient<span class="token punctuation">.</span>discovery <span class="token keyword">import</span> build
<span class="token keyword">from</span> google_auth_oauthlib<span class="token punctuation">.</span>flow <span class="token keyword">import</span> InstalledAppFlow
<span class="token keyword">from</span> google<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>transport<span class="token punctuation">.</span>requests <span class="token keyword">import</span> Request
<span class="token keyword">from</span> google<span class="token punctuation">.</span>oauth2<span class="token punctuation">.</span>credentials <span class="token keyword">import</span> Credentials
<span class="token keyword">from</span> google<span class="token punctuation">.</span>oauth2 <span class="token keyword">import</span> service_account
<span class="token keyword">from</span> googleapiclient<span class="token punctuation">.</span>http <span class="token keyword">import</span> MediaIoBaseDownload<span class="token punctuation">,</span> MediaFileUpload
<span class="token keyword">from</span> flatten_json <span class="token keyword">import</span> flatten
<span class="token keyword">import</span> networkx <span class="token keyword">as</span> nx
<span class="token keyword">import</span> matplotlib
<span class="token keyword">from</span> networkx<span class="token punctuation">.</span>readwrite <span class="token keyword">import</span> json_graph
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> tracemalloc
<span class="token keyword">import</span> os
<span class="token comment">#from ratelimiter import RateLimiter</span>


<span class="token keyword">class</span> <span class="token class-name">cd</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Context manager for changing the current working directory"""</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> newPath<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>newPath <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>expanduser<span class="token punctuation">(</span>newPath<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__enter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>savedPath <span class="token operator">=</span> os<span class="token punctuation">.</span>getcwd<span class="token punctuation">(</span><span class="token punctuation">)</span>
        os<span class="token punctuation">.</span>chdir<span class="token punctuation">(</span>self<span class="token punctuation">.</span>newPath<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__exit__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> etype<span class="token punctuation">,</span> value<span class="token punctuation">,</span> traceback<span class="token punctuation">)</span><span class="token punctuation">:</span>
        os<span class="token punctuation">.</span>chdir<span class="token punctuation">(</span>self<span class="token punctuation">.</span>savedPath<span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">search_results_page</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>base_url <span class="token operator">=</span> <span class="token string">"https://www.loc.gov/collections"</span><span class="token punctuation">,</span>collection <span class="token operator">=</span> <span class="token string">"united-states-reports"</span><span class="token punctuation">,</span>json_parameter <span class="token operator">=</span> <span class="token string">"fo=json"</span><span class="token punctuation">,</span>results_per_page <span class="token operator">=</span> <span class="token string">"c=79"</span><span class="token punctuation">,</span>query_param <span class="token operator">=</span> <span class="token string">"?"</span><span class="token punctuation">,</span>page_param <span class="token operator">=</span><span class="token string">"sp="</span><span class="token punctuation">,</span>page_num <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment">#pprint(num_columns)</span>
        self<span class="token punctuation">.</span>search_url <span class="token operator">=</span> self<span class="token punctuation">.</span>create_search_url<span class="token punctuation">(</span>base_url<span class="token punctuation">,</span>collection<span class="token punctuation">,</span>json_parameter<span class="token punctuation">,</span>results_per_page<span class="token punctuation">,</span>query_param<span class="token punctuation">,</span>page_param<span class="token punctuation">,</span>page_num<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>response <span class="token operator">=</span> self<span class="token punctuation">.</span>request_data<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>response_json <span class="token operator">=</span> self<span class="token punctuation">.</span>response_to_json<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">#self.soup_html = self.html_parse()</span>
        self<span class="token punctuation">.</span>next_url <span class="token operator">=</span> self<span class="token punctuation">.</span>get_next_url<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>page_num <span class="token operator">=</span> page_num

    <span class="token keyword">def</span> <span class="token function">to_json</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> file_name <span class="token operator">=</span> <span class="token string">'result_'</span><span class="token punctuation">,</span>file_num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> extension <span class="token operator">=</span><span class="token string">".json"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        output_name <span class="token operator">=</span> file_name <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>file_num<span class="token punctuation">)</span>
        output_name <span class="token operator">=</span> output_name <span class="token operator">+</span> extension
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>output_name<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> outfile<span class="token punctuation">:</span>
            json<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>self<span class="token punctuation">.</span>response_json<span class="token punctuation">,</span> outfile<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">to_pandas</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        df <span class="token operator">=</span> nx<span class="token punctuation">.</span>to_pandas_edgelist<span class="token punctuation">(</span>self<span class="token punctuation">.</span>graph<span class="token punctuation">)</span>
        <span class="token keyword">return</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">to_csv</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>file_name <span class="token operator">=</span> <span class="token string">'result_'</span><span class="token punctuation">,</span>file_num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> extension <span class="token operator">=</span><span class="token string">".csv"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        output_name <span class="token operator">=</span> file_name <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>file_num<span class="token punctuation">)</span>
        output_name <span class="token operator">=</span> output_name <span class="token operator">+</span> extension
        df <span class="token operator">=</span> self<span class="token punctuation">.</span>to_pandas<span class="token punctuation">(</span><span class="token punctuation">)</span>
        df<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span>output_name<span class="token punctuation">)</span>


    <span class="token keyword">def</span> <span class="token function">write_graphml</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>file_name <span class="token operator">=</span> <span class="token string">'result_'</span><span class="token punctuation">,</span> file_num<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> extension <span class="token operator">=</span> <span class="token string">".graphml"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        output_name <span class="token operator">=</span> file_name <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>file_num<span class="token punctuation">)</span>
        output_name <span class="token operator">=</span> output_name <span class="token operator">+</span> extension
        nx<span class="token punctuation">.</span>write_graphml<span class="token punctuation">(</span>self<span class="token punctuation">.</span>graph<span class="token punctuation">,</span> output_name<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">write_to_file</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>data <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">,</span> file_name <span class="token operator">=</span> <span class="token string">'result_'</span><span class="token punctuation">,</span>file_num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> extension <span class="token operator">=</span> <span class="token string">".json"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        output_name <span class="token operator">=</span> file_name <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>file_num<span class="token punctuation">)</span>
        output_name <span class="token operator">=</span> output_name <span class="token operator">+</span> extension
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>output_name<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> outfile<span class="token punctuation">:</span>
            json<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>data<span class="token punctuation">,</span> outfile<span class="token punctuation">)</span>


    <span class="token keyword">def</span> <span class="token function">node_gen_2</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">,</span> root <span class="token operator">=</span><span class="token string">'result'</span><span class="token punctuation">,</span> node_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> edge_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> previous_k <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">,</span> previous_edge <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">,</span> graph <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment">#root = root </span>
        <span class="token keyword">if</span> <span class="token builtin">type</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token keyword">is</span> <span class="token builtin">dict</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> data<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> k <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">and</span> k <span class="token keyword">not</span> <span class="token keyword">in</span> node_list<span class="token punctuation">:</span>
                    graph<span class="token punctuation">.</span>add_node<span class="token punctuation">(</span>k<span class="token punctuation">,</span> <span class="token builtin">type</span> <span class="token operator">=</span> k<span class="token punctuation">)</span>
                    <span class="token comment">#node_list.append((k, {'type' : k}))</span>
                    <span class="token comment">#(1, 2, color='red', weight=0.84, size=300)\</span>
                    graph<span class="token punctuation">.</span>add_edge<span class="token punctuation">(</span>root<span class="token punctuation">,</span>k<span class="token punctuation">,</span> relationship <span class="token operator">=</span> <span class="token string">"of"</span><span class="token punctuation">,</span> <span class="token builtin">type</span> <span class="token operator">=</span> <span class="token string">"root"</span><span class="token punctuation">)</span>
                    <span class="token comment">#edge_list.append((root , k, {"relationship" : "of"}, {"type" : 'root'}))</span>
                <span class="token comment">#pprint('passing_value')</span>
                <span class="token comment">#save k</span>
                previous_k <span class="token operator">=</span> k
                previous_edge <span class="token operator">=</span> <span class="token punctuation">(</span>root <span class="token punctuation">,</span> k<span class="token punctuation">)</span>
                self<span class="token punctuation">.</span>node_gen_2<span class="token punctuation">(</span>v<span class="token punctuation">,</span>root <span class="token operator">=</span> root<span class="token punctuation">,</span> node_list <span class="token operator">=</span> node_list<span class="token punctuation">,</span>edge_list <span class="token operator">=</span> edge_list<span class="token punctuation">,</span> previous_k <span class="token operator">=</span> k<span class="token punctuation">,</span> previous_edge <span class="token operator">=</span> previous_edge<span class="token punctuation">,</span> graph <span class="token operator">=</span> graph<span class="token punctuation">)</span>

        <span class="token keyword">elif</span> <span class="token builtin">type</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token keyword">is</span> <span class="token builtin">list</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> item <span class="token keyword">in</span> data<span class="token punctuation">:</span>
                <span class="token comment">#pprint('passing_data')</span>

                self<span class="token punctuation">.</span>node_gen_2<span class="token punctuation">(</span>item<span class="token punctuation">,</span>root <span class="token operator">=</span> root<span class="token punctuation">,</span> node_list <span class="token operator">=</span> node_list<span class="token punctuation">,</span>edge_list <span class="token operator">=</span> edge_list<span class="token punctuation">,</span>previous_k <span class="token operator">=</span> previous_k<span class="token punctuation">,</span> previous_edge<span class="token operator">=</span> previous_edge<span class="token punctuation">,</span> graph <span class="token operator">=</span> graph<span class="token punctuation">)</span>
                <span class="token comment">#create_edge to k</span>

        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment">#this item is no longer a dictionary or list</span>
            pprint<span class="token punctuation">(</span><span class="token string">'appending_data'</span><span class="token punctuation">)</span>
            <span class="token comment">#create edge to k</span>
            <span class="token keyword">if</span> data <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                graph<span class="token punctuation">.</span>add_node<span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token builtin">type</span> <span class="token operator">=</span> data<span class="token punctuation">)</span>
                <span class="token comment">#node_list.append((data, {"type" : data}))</span>
                graph<span class="token punctuation">.</span>add_edge<span class="token punctuation">(</span>previous_k<span class="token punctuation">,</span> data<span class="token punctuation">,</span> relationship <span class="token operator">=</span> <span class="token string">"is"</span><span class="token punctuation">,</span> <span class="token builtin">type</span> <span class="token operator">=</span> previous_k<span class="token punctuation">)</span>
                <span class="token comment">#edge_list.append((previous_k ,data,{'relationship': "is"}, {'type' : data}))</span>
                <span class="token comment">#edge_list.append((root,data))</span>

    <span class="token comment">#flatten(hierarchak)_dict)</span>
        <span class="token keyword">return</span> graph 

    
    <span class="token keyword">def</span> <span class="token function">node_runner</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>data<span class="token punctuation">,</span>graph<span class="token punctuation">)</span><span class="token punctuation">:</span>
        
        node_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        edge_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> item <span class="token keyword">in</span> data<span class="token punctuation">:</span>
            <span class="token comment">#root = item['title']</span>
            graph <span class="token operator">=</span> self<span class="token punctuation">.</span>node_gen_2<span class="token punctuation">(</span>data <span class="token operator">=</span> item<span class="token punctuation">,</span> node_list <span class="token operator">=</span> node_list<span class="token punctuation">,</span> graph <span class="token operator">=</span> graph<span class="token punctuation">)</span>
        <span class="token comment">#pprint(edge_list)</span>
        <span class="token keyword">return</span> graph

    <span class="token keyword">def</span> <span class="token function">node_generator</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">,</span> root <span class="token operator">=</span><span class="token string">'title_testing'</span><span class="token punctuation">,</span> node_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> edge_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> previous_k <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">,</span> previous_edge <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment">#pprint(data)</span>
        <span class="token keyword">if</span> <span class="token builtin">type</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token keyword">is</span> <span class="token builtin">dict</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> data<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> k <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">and</span> k <span class="token keyword">not</span> <span class="token keyword">in</span> node_list<span class="token punctuation">:</span>
                    node_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>k<span class="token punctuation">)</span>
                    edge_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>root <span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token comment">#pprint('passing_value')</span>
                <span class="token comment">#save k</span>
                previous_k <span class="token operator">=</span> k
                previous_edge <span class="token operator">=</span> <span class="token punctuation">(</span>root <span class="token punctuation">,</span> k<span class="token punctuation">)</span>
                self<span class="token punctuation">.</span>node_generator<span class="token punctuation">(</span>v<span class="token punctuation">,</span>root <span class="token operator">=</span> root<span class="token punctuation">,</span> node_list <span class="token operator">=</span> node_list<span class="token punctuation">,</span>edge_list <span class="token operator">=</span> edge_list<span class="token punctuation">,</span> previous_k <span class="token operator">=</span> k<span class="token punctuation">,</span> previous_edge <span class="token operator">=</span> previous_edge<span class="token punctuation">)</span>

        <span class="token keyword">elif</span> <span class="token builtin">type</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token keyword">is</span> <span class="token builtin">list</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> item <span class="token keyword">in</span> data<span class="token punctuation">:</span>
                <span class="token comment">#pprint('passing_data')</span>

                self<span class="token punctuation">.</span>node_generator<span class="token punctuation">(</span>item<span class="token punctuation">,</span>root <span class="token operator">=</span> root<span class="token punctuation">,</span> node_list <span class="token operator">=</span> node_list<span class="token punctuation">,</span>edge_list <span class="token operator">=</span> edge_list<span class="token punctuation">,</span>previous_k <span class="token operator">=</span> previous_k<span class="token punctuation">,</span> previous_edge<span class="token operator">=</span> previous_edge<span class="token punctuation">)</span>
                <span class="token comment">#create_edge to k</span>

        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment">#this item is no longer a dictionary or list</span>
            pprint<span class="token punctuation">(</span><span class="token string">'appending_data'</span><span class="token punctuation">)</span>
            <span class="token comment">#create edge to k</span>
            <span class="token keyword">if</span> data <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                node_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
                edge_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>previous_k <span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
                edge_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment">#flatten(hierarchak)_dict)</span>
        <span class="token keyword">return</span> node_list<span class="token punctuation">,</span> edge_list 
        <span class="token comment">#self.json_graph = self.create_json_graph()</span>


    <span class="token keyword">def</span> <span class="token function">create_json_graph</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment">#graph = nx.Graph(self.response_json)</span>
        graph <span class="token operator">=</span> nx<span class="token punctuation">.</span>from_dict_of_dicts<span class="token punctuation">(</span>self<span class="token punctuation">.</span>response_json<span class="token punctuation">)</span>
        <span class="token comment">#graph = json_graph.node_link_graph(self.response_json)</span>
        nx<span class="token punctuation">.</span>draw<span class="token punctuation">(</span>graph<span class="token punctuation">)</span>
        <span class="token keyword">return</span> graph
        
        <span class="token comment">#self.node_list = self.node_generator`</span>



    <span class="token keyword">def</span> <span class="token function">create_search_result_node</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
     
        <span class="token keyword">for</span> item <span class="token keyword">in</span> self<span class="token punctuation">.</span>response_json_flat<span class="token punctuation">:</span>
            <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> item<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> k <span class="token keyword">not</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>column_lookup_table<span class="token punctuation">:</span>
                    column_string <span class="token operator">=</span> self<span class="token punctuation">.</span>colnum_string<span class="token punctuation">(</span><span class="token punctuation">)</span>

                    self<span class="token punctuation">.</span>column_lookup_table<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>colnum_string<span class="token punctuation">(</span>self<span class="token punctuation">.</span>num_columns<span class="token punctuation">)</span>
                    self<span class="token punctuation">.</span>num_columns <span class="token operator">+=</span> <span class="token number">1</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    <span class="token keyword">continue</span>

    <span class="token keyword">def</span> <span class="token function">append_to_data_list</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>rnge<span class="token punctuation">,</span>d<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#rename to _data_list</span>
        request_body <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">'range'</span><span class="token punctuation">:</span> rnge<span class="token punctuation">,</span>
            <span class="token string">"majorDimension"</span><span class="token punctuation">:</span> <span class="token string">"COLUMNS"</span><span class="token punctuation">,</span>
            <span class="token string">"values"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>d<span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> request_body
        <span class="token comment">#data_list.append(request_body_tmp)</span>

    <span class="token keyword">def</span> <span class="token function">map_column_to_range</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>column_key<span class="token punctuation">)</span><span class="token punctuation">:</span>
        
        rnge <span class="token operator">=</span> <span class="token string">"'Sheet1'"</span> <span class="token operator">+</span> <span class="token string">"!"</span> <span class="token operator">+</span> column_key <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> rnge
                

    <span class="token keyword">def</span> <span class="token function">colnum_string</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>num_columns<span class="token punctuation">)</span><span class="token punctuation">:</span>
        string <span class="token operator">=</span> <span class="token string">""</span>
        <span class="token comment">#pprint("conlum_string")</span>
        <span class="token comment">#pprint(num_columns)</span>
        <span class="token keyword">while</span> num_columns <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>
            num_columns<span class="token punctuation">,</span> remainder <span class="token operator">=</span> <span class="token builtin">divmod</span><span class="token punctuation">(</span>num_columns <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">)</span>
            string <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">65</span> <span class="token operator">+</span> remainder<span class="token punctuation">)</span> <span class="token operator">+</span> string
            <span class="token comment">#pprint(string)</span>
        <span class="token keyword">return</span> string

    <span class="token keyword">def</span> <span class="token function">map_columns_to_lookup_table</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token comment">#print('first_map_columns_print')</span>
        <span class="token comment">#num_columns_tmp = self.num_columns</span>
        <span class="token comment">#pprint(num_columns_tmp)</span>
        <span class="token keyword">for</span> item <span class="token keyword">in</span> self<span class="token punctuation">.</span>response_json_flat<span class="token punctuation">:</span>
            <span class="token keyword">for</span> k <span class="token keyword">in</span> item<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                num_columns_tmp <span class="token operator">=</span> self<span class="token punctuation">.</span>num_columns
                <span class="token keyword">if</span> k <span class="token keyword">not</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>column_lookup_table<span class="token punctuation">:</span>
                    <span class="token comment">#print('second_map_Columns_print')</span>
                    <span class="token comment">#pprint(num_columns_tmp)</span>
                    self<span class="token punctuation">.</span>column_lookup_table<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>colnum_string<span class="token punctuation">(</span>num_columns <span class="token operator">=</span> num_columns_tmp<span class="token punctuation">)</span>
                    self<span class="token punctuation">.</span>num_columns <span class="token operator">=</span> self<span class="token punctuation">.</span>num_columns <span class="token operator">+</span> <span class="token number">1</span>
       
                    <span class="token comment">#append range to request... </span>
                    <span class="token comment">#append collumn to batch lookup</span>
                

                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    <span class="token keyword">continue</span>
    
    <span class="token keyword">def</span> <span class="token function">column_request_list_generator</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        request_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> self<span class="token punctuation">.</span>column_lookup_table<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            rnge <span class="token operator">=</span> self<span class="token punctuation">.</span>map_column_to_range<span class="token punctuation">(</span>k<span class="token punctuation">)</span>
            request_body <span class="token operator">=</span> self<span class="token punctuation">.</span>append_to_data_list<span class="token punctuation">(</span>rnge<span class="token punctuation">,</span>v<span class="token punctuation">)</span>
            <span class="token comment">#pprint(request_body)</span>
            request_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>request_body<span class="token punctuation">)</span>
        <span class="token keyword">return</span> request_list





        <span class="token comment">#return column_lookup_table</span>

    <span class="token keyword">def</span> <span class="token function">get_next_url</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>response_json<span class="token punctuation">[</span><span class="token string">'pagination'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'next'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">create_search_url</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>base_url<span class="token punctuation">,</span>collection<span class="token punctuation">,</span>json_parameter<span class="token punctuation">,</span>results_per_page<span class="token punctuation">,</span>query_param<span class="token punctuation">,</span>page_param<span class="token punctuation">,</span>page_num<span class="token punctuation">)</span><span class="token punctuation">:</span>
        url_sep <span class="token operator">=</span><span class="token string">"/"</span>
        page_param <span class="token operator">=</span> page_param <span class="token operator">+</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>page_num<span class="token punctuation">)</span><span class="token punctuation">)</span>
        query <span class="token operator">=</span> <span class="token string">"&amp;"</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span>json_parameter<span class="token punctuation">,</span>results_per_page<span class="token punctuation">,</span>page_param<span class="token punctuation">]</span><span class="token punctuation">)</span>
        query <span class="token operator">=</span> query_param <span class="token operator">+</span> query
        search_url <span class="token operator">=</span> url_sep<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span>base_url<span class="token punctuation">,</span>collection<span class="token punctuation">,</span>query<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token comment">#pprint(search_url)</span>
        
        <span class="token keyword">return</span> search_url

    <span class="token keyword">def</span> <span class="token function">say_hello</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        pprint<span class="token punctuation">(</span>self<span class="token punctuation">.</span>base_url<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">request_data</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        headers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'User-Agent'</span><span class="token punctuation">:</span><span class="token string">'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_2) AppleWebKit/601.3.11 (KHTML, like Gecko) Version/9.0.2 Safari/601.3.9'</span><span class="token punctuation">,</span>
                    <span class="token string">'Accept-Encoding'</span><span class="token punctuation">:</span> <span class="token string">'identity'</span>
                <span class="token punctuation">}</span>
        <span class="token keyword">return</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>self<span class="token punctuation">.</span>search_url<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">response_to_json</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">html_parse</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        soup<span class="token operator">=</span>BeautifulSoup<span class="token punctuation">(</span>self<span class="token punctuation">.</span>response<span class="token punctuation">.</span>content<span class="token punctuation">,</span><span class="token string">'lxml'</span><span class="token punctuation">)</span>
        <span class="token comment">#pprint(soup)</span>
        <span class="token keyword">return</span> soup

    <span class="token keyword">def</span> <span class="token function">flatten_result</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        flat_result_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> item <span class="token keyword">in</span> self<span class="token punctuation">.</span>response_json<span class="token punctuation">[</span><span class="token string">'results'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            flat_json <span class="token operator">=</span> flatten<span class="token punctuation">(</span>item<span class="token punctuation">)</span>
            flat_result_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>flat_json<span class="token punctuation">)</span>
        <span class="token keyword">return</span> flat_result_list



<span class="token keyword">class</span> <span class="token class-name">search_result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>dict_item<span class="token punctuation">,</span>num_columns<span class="token punctuation">,</span>colnum_string<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>key <span class="token operator">=</span> dict_item<span class="token punctuation">.</span>key<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>value <span class="token operator">=</span> dict_item<span class="token punctuation">.</span>value<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>column_string <span class="token operator">=</span> colnum_string
        self<span class="token punctuation">.</span>index <span class="token operator">=</span> num_columns
        self<span class="token punctuation">.</span><span class="token builtin">range</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>create_column_range_string<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>request_body <span class="token operator">=</span> self<span class="token punctuation">.</span>create_column_request<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">create_column_request</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        request_body <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">'range'</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span><span class="token builtin">range</span><span class="token punctuation">,</span>
            <span class="token string">"majorDimension"</span><span class="token punctuation">:</span> <span class="token string">"COLUMNS"</span><span class="token punctuation">,</span>
            <span class="token string">"values"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>value<span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> request_body

    
    <span class="token keyword">def</span> <span class="token function">create_column_range_string</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        rnge <span class="token operator">=</span> <span class="token string">"'Sheet1'"</span> <span class="token operator">+</span> <span class="token string">"!"</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>column_string <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> rnge
    <span class="token keyword">def</span> <span class="token function">colnum_string</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> num_columns<span class="token punctuation">)</span><span class="token punctuation">:</span>
        string <span class="token operator">=</span> <span class="token string">""</span>
        <span class="token keyword">while</span> num_columns <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>
            num_columns<span class="token punctuation">,</span> remainder <span class="token operator">=</span> <span class="token builtin">divmod</span><span class="token punctuation">(</span>num_columns <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">)</span>
            string <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">65</span> <span class="token operator">+</span> remainder<span class="token punctuation">)</span> <span class="token operator">+</span> string
        <span class="token keyword">return</span> string

<span class="token keyword">class</span> <span class="token class-name">google_drive</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>creds<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>service <span class="token operator">=</span> self<span class="token punctuation">.</span>get_drive_service<span class="token punctuation">(</span>creds<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        pprint<span class="token punctuation">(</span><span class="token string">"hello I exist"</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">get_drive_service</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> creds<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""Shows basic usage of the Drive v3 API.
        Prints the names and ids of the first 10 files the user has access to.
        """</span>
        SCOPES <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token comment">#creds = None</span>
        <span class="token comment"># The file token.json stores the user's access and refresh tokens, and is</span>
        <span class="token comment"># created automatically when the authorization flow completes for the first</span>
        <span class="token comment"># time.</span>

        service <span class="token operator">=</span> build<span class="token punctuation">(</span><span class="token string">'drive'</span><span class="token punctuation">,</span> <span class="token string">'v3'</span><span class="token punctuation">,</span> credentials<span class="token operator">=</span>creds<span class="token punctuation">)</span>

        <span class="token comment"># Call the Drive v3 API</span>
        results <span class="token operator">=</span> service<span class="token punctuation">.</span>files<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">list</span><span class="token punctuation">(</span>
            pageSize<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> fields<span class="token operator">=</span><span class="token string">"nextPageToken, files(id, name)"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token punctuation">)</span>
        items <span class="token operator">=</span> results<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'files'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> <span class="token keyword">not</span> items<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'No files found.'</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Files:'</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> item <span class="token keyword">in</span> items<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">u'{0} ({1})'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> item<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token keyword">return</span> service
    
    

    <span class="token keyword">def</span> <span class="token function">create_folder</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>title<span class="token punctuation">)</span><span class="token punctuation">:</span>
        drive_service <span class="token operator">=</span> self<span class="token punctuation">.</span>service
        file_metadata <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'{}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">'mimeType'</span><span class="token punctuation">:</span> <span class="token string">'application/vnd.google-apps.folder'</span>
        <span class="token punctuation">}</span>
        <span class="token builtin">file</span> <span class="token operator">=</span> drive_service<span class="token punctuation">.</span>files<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>create<span class="token punctuation">(</span>body<span class="token operator">=</span>file_metadata<span class="token punctuation">,</span>
                                            fields<span class="token operator">=</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Folder ID: %s'</span> <span class="token operator">%</span> <span class="token builtin">file</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>



    <span class="token keyword">def</span> <span class="token function">add_spreadsheet_to_folder</span><span class="token punctuation">(</span>self <span class="token punctuation">,</span>folder_id<span class="token punctuation">,</span>title<span class="token punctuation">)</span><span class="token punctuation">:</span>
        drive_service <span class="token operator">=</span> self<span class="token punctuation">.</span>service
    
        file_metadata <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'{}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">'parents'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>folder_id<span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'mimeType'</span><span class="token punctuation">:</span> <span class="token string">'application/vnd.google-apps.spreadsheet'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>

        res <span class="token operator">=</span> drive_service<span class="token punctuation">.</span>files<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>create<span class="token punctuation">(</span>body<span class="token operator">=</span>file_metadata<span class="token punctuation">)</span><span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">#print(res)</span>

        <span class="token keyword">return</span> res

<span class="token keyword">class</span> <span class="token class-name">google_sheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>creds<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>service <span class="token operator">=</span>self<span class="token punctuation">.</span>get_sheet_service<span class="token punctuation">(</span>creds<span class="token punctuation">)</span>


    <span class="token keyword">def</span> <span class="token function">get_sheet_service</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>creds<span class="token punctuation">)</span><span class="token punctuation">:</span>
        service <span class="token operator">=</span> build<span class="token punctuation">(</span><span class="token string">'sheets'</span><span class="token punctuation">,</span> <span class="token string">'v4'</span><span class="token punctuation">,</span> credentials<span class="token operator">=</span>creds<span class="token punctuation">)</span>
        <span class="token keyword">return</span> service<span class="token punctuation">.</span>spreadsheets<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">google_creds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>creds_path<span class="token punctuation">)</span><span class="token punctuation">:</span>

        self<span class="token punctuation">.</span>creds <span class="token operator">=</span> self<span class="token punctuation">.</span>get_creds<span class="token punctuation">(</span>creds_path<span class="token punctuation">)</span>
   
    <span class="token keyword">def</span> <span class="token function">get_creds</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>creds_path<span class="token punctuation">)</span><span class="token punctuation">:</span>

        creds <span class="token operator">=</span> <span class="token boolean">None</span>
        <span class="token comment"># The file token.json stores the user's access and refresh tokens, and is</span>
        <span class="token comment"># created automatically when the authorization flow completes for the first</span>
        <span class="token comment"># time.</span>
        <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">'token.json'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            creds <span class="token operator">=</span> Credentials<span class="token punctuation">.</span>from_authorized_user_file<span class="token punctuation">(</span><span class="token string">'token.json'</span><span class="token punctuation">,</span> SCOPES<span class="token punctuation">)</span>
        <span class="token comment"># If there are no (valid) credentials available, let the user log in.</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> creds <span class="token keyword">or</span> <span class="token keyword">not</span> creds<span class="token punctuation">.</span>valid<span class="token punctuation">:</span>
            <span class="token keyword">if</span> creds <span class="token keyword">and</span> creds<span class="token punctuation">.</span>expired <span class="token keyword">and</span> creds<span class="token punctuation">.</span>refresh_token<span class="token punctuation">:</span>
                creds<span class="token punctuation">.</span>refresh<span class="token punctuation">(</span>Request<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"no creds"</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                creds <span class="token operator">=</span> service_account<span class="token punctuation">.</span>Credentials<span class="token punctuation">.</span>from_service_account_file<span class="token punctuation">(</span>creds_path<span class="token punctuation">)</span>
                <span class="token comment">#creds = ServiceAccountCredentials.from_json_keyfile_name('add_json_file_here.json', SCOPES)</span>
                <span class="token comment">#flow = InstalledAppFlow.from_client_secrets_file(</span>
                <span class="token comment">#    'credentials.json', SCOPES)</span>
                <span class="token comment">#creds = flow.run_local_server(port=0)</span>
            <span class="token comment"># Save the credentials for the next run</span>
            <span class="token comment">#with open('token.json', 'w') as token:</span>
            <span class="token comment">#    token.write(creds.to_json())</span>
        <span class="token keyword">return</span> creds

<span class="token keyword">class</span> <span class="token class-name">config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>file_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment">#self.yaml_stream = file("config.yaml", 'r')</span>
        self<span class="token punctuation">.</span>data <span class="token operator">=</span> self<span class="token punctuation">.</span>load_config<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>


    <span class="token keyword">def</span> <span class="token function">load_config</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>file_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment">#print("test")</span>
        stream <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span>
        data <span class="token operator">=</span> yaml<span class="token punctuation">.</span>load<span class="token punctuation">(</span>stream<span class="token punctuation">,</span>Loader <span class="token operator">=</span> Loader<span class="token punctuation">)</span>
        <span class="token comment">#pprint(data)</span>
        <span class="token keyword">return</span> data

<span class="token keyword">def</span> <span class="token function">create_google_credentials_object</span><span class="token punctuation">(</span>creds_path <span class="token operator">=</span> <span class="token string">'credentials.json'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    google_credentials_object <span class="token operator">=</span> google_creds<span class="token punctuation">(</span>creds_path<span class="token punctuation">)</span>
    <span class="token keyword">return</span> google_credentials_object
    
<span class="token keyword">def</span> <span class="token function">create_config_object</span><span class="token punctuation">(</span>file_path <span class="token operator">=</span> <span class="token string">'config.yaml'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    config_object <span class="token operator">=</span> config<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
    <span class="token keyword">return</span> config_object


<span class="token keyword">def</span> <span class="token function">search_result_generator</span><span class="token punctuation">(</span>condition <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#column_lookup_table = {}</span>
    <span class="token comment">#pprint(num_columns)</span>
    page_num <span class="token operator">=</span> <span class="token number">1</span>
    column_lookup_table <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">while</span> condition <span class="token operator">==</span><span class="token boolean">True</span><span class="token punctuation">:</span>
        <span class="token comment">#pprint(num_columns)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">61</span><span class="token punctuation">)</span>
        search_results_page_object <span class="token operator">=</span> create_search_results_page_object<span class="token punctuation">(</span>page_num <span class="token operator">=</span> page_num<span class="token punctuation">)</span>
        <span class="token keyword">if</span> search_results_page_object<span class="token punctuation">.</span>next_url <span class="token operator">!=</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            condition <span class="token operator">=</span> <span class="token boolean">True</span>
            page_num <span class="token operator">=</span> page_num <span class="token operator">+</span> <span class="token number">1</span>            
            <span class="token keyword">yield</span> <span class="token punctuation">(</span>search_results_page_object<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            condition <span class="token operator">=</span> <span class="token boolean">False</span>
            <span class="token keyword">yield</span> <span class="token punctuation">(</span>search_results_page_object<span class="token punctuation">)</span>
        
<span class="token keyword">def</span> <span class="token function">create_search_results_page_object</span><span class="token punctuation">(</span>base_url <span class="token operator">=</span> <span class="token string">"https://www.loc.gov/collections"</span><span class="token punctuation">,</span>collection <span class="token operator">=</span> <span class="token string">"united-states-reports"</span><span class="token punctuation">,</span>json_parameter <span class="token operator">=</span> <span class="token string">"fo=json"</span><span class="token punctuation">,</span>results_per_page <span class="token operator">=</span> <span class="token string">"c=70"</span><span class="token punctuation">,</span>query_param <span class="token operator">=</span> <span class="token string">"?"</span><span class="token punctuation">,</span>page_param <span class="token operator">=</span><span class="token string">"sp="</span><span class="token punctuation">,</span>page_num <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#search = search_results(base_url,collection,json_parameter,results_per_page,query_param,page_param,page_num)</span>
    <span class="token comment">#pprint(search.search_url)</span>
    <span class="token comment">#pprint(num_columns)</span>
    <span class="token keyword">return</span> search_results_page<span class="token punctuation">(</span>base_url<span class="token punctuation">,</span>collection<span class="token punctuation">,</span>json_parameter<span class="token punctuation">,</span>results_per_page<span class="token punctuation">,</span>query_param<span class="token punctuation">,</span>page_param<span class="token punctuation">,</span>page_num<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">create_google_drive_object</span><span class="token punctuation">(</span>google_creds<span class="token punctuation">)</span><span class="token punctuation">:</span>
    drive_service_object <span class="token operator">=</span> google_drive<span class="token punctuation">(</span>google_creds<span class="token punctuation">)</span>
    <span class="token keyword">return</span> drive_service_object

<span class="token keyword">def</span> <span class="token function">create_google_sheet_object</span><span class="token punctuation">(</span>google_creds<span class="token punctuation">)</span><span class="token punctuation">:</span>
    sheet_service_object <span class="token operator">=</span> google_sheet<span class="token punctuation">(</span>google_creds<span class="token punctuation">)</span>
    <span class="token keyword">return</span> sheet_service_object

<span class="token keyword">def</span> <span class="token function">create_new_google_sheet</span><span class="token punctuation">(</span>google_drive_object<span class="token punctuation">,</span>folder_id<span class="token punctuation">,</span>title<span class="token punctuation">)</span><span class="token punctuation">:</span>
    sheet_meta_data <span class="token operator">=</span> google_drive_object<span class="token punctuation">.</span>add_spreadsheet_to_folder<span class="token punctuation">(</span>folder_id<span class="token punctuation">,</span> title<span class="token punctuation">)</span>
    <span class="token keyword">return</span> sheet_meta_data

<span class="token keyword">def</span> <span class="token function">flatten_result</span><span class="token punctuation">(</span>result_json<span class="token punctuation">)</span><span class="token punctuation">:</span>
    flat_json <span class="token operator">=</span> flatten<span class="token punctuation">(</span>result_json<span class="token punctuation">)</span>
    <span class="token keyword">return</span> flat_json

<span class="token keyword">def</span> <span class="token function">write_last_page_num</span><span class="token punctuation">(</span>page_num<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'last_page_num.txt'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>page_num<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    tracemalloc<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">#rate_limiter = RateLimiter(max_calls=1, period=60)</span>
    <span class="token comment">#cd to output</span>
    <span class="token comment">#result = create_search_results_page_object()</span>
    <span class="token comment">#with cd("output"):</span>
    <span class="token comment">#    result.write_to_file(data = result.dict_of_dicts, file_num = 1)</span>

    <span class="token keyword">for</span> obj <span class="token keyword">in</span> search_result_generator<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>   
        page_num <span class="token operator">=</span> obj<span class="token punctuation">.</span>page_num
        <span class="token keyword">with</span> cd<span class="token punctuation">(</span><span class="token string">"output_2"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment">#print('hahaha')</span>
            obj<span class="token punctuation">.</span>to_json<span class="token punctuation">(</span>file_num <span class="token operator">=</span> page_num<span class="token punctuation">)</span>
            <span class="token comment">#obj.write_graphml(file_num= page_num)</span>
            <span class="token comment">#obj.to_pandas()</span>
            <span class="token comment">#obj.write_to_file(data = obj.dict_of_dicts, file_num = page_num)</span>
            <span class="token comment">#obj.to_csv()</span>
        write_last_page_num<span class="token punctuation">(</span>page_num<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{} Search Results Crawled"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>page_num<span class="token punctuation">)</span><span class="token punctuation">)</span>


    
    snapshot <span class="token operator">=</span> tracemalloc<span class="token punctuation">.</span>take_snapshot<span class="token punctuation">(</span><span class="token punctuation">)</span>
    top_stats <span class="token operator">=</span> snapshot<span class="token punctuation">.</span>statistics<span class="token punctuation">(</span><span class="token string">'lineno'</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[ Top 10 ]"</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> stat <span class="token keyword">in</span> top_stats<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>stat<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span>

        
        

    </code></pre></div></section><hr/><footer><div class="bio"><p>Maintained by <strong>Justin Napolitano</strong>. <!-- --> <a href="https://twitter.com/just_napolitano">Follow me on Twitter</a></p></div></footer></article><nav class="blog-post-nav"><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" href="/carbon-shipping-projections/">← <!-- -->Monte Carlo Projection of the Annual Cost of Shipping Carbon from Europe to the United States</a></li><li><a rel="next" href="/neo4j_integration/">Integrating JSON data to your Neo4j Stack<!-- --> →</a></li></ul></nav></main><footer>© <!-- -->2022<!-- -->, Created by<!-- --> <a href="https://jnapolitano.io">Justin Napolitano</a></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/loc_crawler/";window.___webpackCompilationHash="d94363f05044c33a6781";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-67664a8ccc6c9f02b880.js"],"app":["/app-c8d1e6b1e07552f29524.js"],"component---src-pages-404-js":["/component---src-pages-404-js-27981ca7dd461cb4280e.js"],"component---src-pages-index-js":["/component---src-pages-index-js-59a21146d37aa180d12f.js"],"component---src-pages-using-typescript-tsx":["/component---src-pages-using-typescript-tsx-2f9b97cf148785549d09.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-2fd61fd1c97edc75b172.js"]};/*]]>*/</script><script src="/polyfill-67664a8ccc6c9f02b880.js" nomodule=""></script><script src="/component---src-templates-blog-post-js-2fd61fd1c97edc75b172.js" async=""></script><script src="/commons-9979cba14fa891b0ecd4.js" async=""></script><script src="/app-c8d1e6b1e07552f29524.js" async=""></script><script src="/framework-e413e527015be9a1bdfd.js" async=""></script><script src="/webpack-runtime-8d4d3bcfd5afb11d1043.js" async=""></script></body></html>